---
title: 'Template - Lab 3: Exploring Happiness'
subtitle: "Due: Thursday 10/03/2019 by 10 pm"
author: "Lynna Chu"

date: "09/26/2019"
output: html_document
---


## Background

The General Social Survey (GSS) has been run by NORC every other year since 1972 to keep track of current opinions across the United States. We are working with an excerpt of the dataset that covers years 1972 to 2016. The variable names along with a brief description are as follows: 

| Variable      | Description   |    
| ------------- |:-------------:| 
| Year          | Year for this respondent | 
| Age           | Age of respondent | 
| Sex           | Sex of respondent     | 
|....           | .....      | 

Now it's important to understand what each column stands for. You can find a codebook with explanations for each of the variables at https://gssdataexplorer.norc.org/

## Data Cleaning 

Initial exploration revealed that some data processing was needed before we could proceed with further visualization. All missing values were encoded with 'NA' as follows:
```{r}
library(tidyverse) #loading tidyverse to use dplyr functions
#importing the code from Lab3.Rmd to initialize happy, and make names lowercase
happy <- readRDS("HAPPY.rds") #initializing the Happy dataframe
names(happy) <- tolower(names(happy)) #making all column headings lowercase for ease of usability 

head(happy) #checking first 6 records


happy
(happy[is.na(happy) | happy == "IAP" | happy == "DK"] = NA) # Here we identified the na values and the values "IAP" and "DK" and inserted "NA"
happy

table(is.na(happy)) # used table() to view how many NA values there were in the Dataset, we saw there to be 36,391 instances of NA across ALL COLUMNS.

ggplot(happy, aes(x=happy)) + geom_bar() + labs(title = "Bar Plot of happiness Index Distribution", x = "Happiness Type", y = "Frequency") #this barchart shows the distribution of the happiness index, as well as NA values in the happy column.

```

In total there were `36391 ` number of missing values for the following `11` variables. 

Variables were also cast into the correct type in order to ease data visualization. This was done by:
```{r}
str(happy) # Looked at the variables' data types to find that age should be converted to Integer


happy <- happy %>% 
  mutate(age = replace(age, age == "89 OR OLDER", 89),age = as.numeric(age)) #used dplyr in order to mutate our happy dataframe, whilst using replace inside of the mutate argument in order to fulfill requirements, then used the final argument to change age's variable class from character to numeric. 

str(happy) # displayed the structure of the new happy_clean to check if the variable age was successfully mutated
```

Factors were also organized into meaningful order as follows: 
```{r}

library(dplyr)

happy_grouped = happy %>% group_by(marital) %>% mutate(avgAge = mean(age, na.rm= TRUE)) # Grouped the marital status in the dataset happy by the average age 

happy_grouped$marital = reorder(happy_grouped$marital, happy_grouped$avgAge) # Based on the the code we pulled from eda; the order in which the dataframe is presented is originally grouped by marital status as well as average age, this is why we see people, for example, with the marital status of never married having a lower average as then say, someone who has been widowed will have a typically higher average age. 

happy_grouped

```


## Data Exploration 

Two variables of interest are `...` and `...`. Their distributions are as follow: 
```{r}
#insert relevant R code here
#include graphics. DESCRIBE your plot in context. Make sure it includes axis labels and appropriate title. 

library(ggplot2)

#Here is a Histogram showing the distribution of ages by different marital statuses.

ggplot(happy_grouped, aes(age, fill = marital)) + geom_histogram(binwidth = 1) + labs(title = "Distribution of Ages by Marital Status", x = "Age (years)", y = "Frequency")

#Here is a bar chart showing the ratios of each party type by the type of happiness.

ggplot(happy, aes(happy, fill = partyid)) + geom_bar(position = 'fill') + labs(title = "Ratio of Party Affiliation by Happiness Index", x = "Happiness", y = "Percentage (out of 100)")



```

The distribution for `...` is `....`, suggesting that `....` 




